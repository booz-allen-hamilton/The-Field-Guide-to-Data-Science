## Feature Engineering Case Study -- Chemoinformatic Search

*Author: Ed Kohlwey*

On one assignment, my team was confronted with the challenge of developing a search over chemical compounds. The goal of chemoinformatic search is to predict the properties that a molecule will exhibit as well as to provide indices over those predicted properties to facilitate data discovery in chemistry-based research. These properties may either be discreet (e.g., “a molecule treats disease x well”) or continuous (e.g., “a molecule may be dissolved up to 100.21 g/ml”).

Molecules are complex 3D structures, which are typically represented as a list of atoms joined by chemical bonds of differing lengths with varying electron domain and molecular geometries. The structures are specified by the 3-space coordinates and the electrostatic potential surface of the atoms in the molecule. Searching this data is a daunting task when one considers that naïve approaches to the problem bear significant semblance to the Graph Isomorphism Problem.[15]
The solution we developed was based on fingerprinting (sometimes also called hashing or locality sensitive hashing). Fingerprinting is a dimensionality reduction technique that dramatically reduces the problem space by summarizing many features, often with relatively little regard to the importance of the feature. When an exact solution is likely to be infeasible, we often turn to heuristic approaches such as fingerprinting.
Our approach used a training set where all the measured properties of the molecules were available. We created a model of how molecular structural similarities might affect their properties. We began by finding all the sub-graphs of each molecule with length n, resulting in a representation similar to the bag-of-words approach from natural language processing. We summarized each molecule fragment in a type of fingerprint called a “Counting Bloom Filter.”
Next, we used several exemplars from the set to create new features. We found the distance from each member of the full training set to each of the exemplars. We fed these features into a non-linear regression algorithm to yield a model that could be used on data that was not in the original training set. This approach can be conceptualized as a “hidden manifold,.” whereby a hidden surface or shape defines how a molecule will exhibit a property. We approximate this shape using a non-linear regression and a set of data with known properties. Once we have the approximate shape, we can use it to predict the properties of new molecules. 
Our approach was multi-staged and complex – we generated sub-graphs, created bloom filters, calculated distance metrics and fit a linear-regression model. This example provides an illustration of how many stages may be involved in producing a sophisticated feature representation. By creatively combining and building “features on features,” we were able to create new representations of data that were richer and more descriptive, yet were able to execute faster and produce better results

